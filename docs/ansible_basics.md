# Базовые стандарты написания плейбуков Ansible

## 1. Структура Playbook

Playbook пишется на языке YAML.

Обязательные поля верхнего уровня: name (название плейбука), hosts (целевые серверы), become (выполнение от root, обычно yes), tasks (список задач).

## 2. Установка пакетов (модуль apt)

Для серверов на базе Debian/Ubuntu используется модуль apt.

Для установки веб-сервера Nginx необходимо:

1. Указать имя пакета (name: nginx).
2. Указать состояние (state: present или latest).
3. Обновить кэш (update_cache: yes).

Пример задачи:

```
- name: Установить веб-сервер Nginx
  apt:
    name: nginx
    state: present
    update_cache: yes

```

## 3. Управление службами (модуль service)

После установки пакета необходимо убедиться, что служба (daemon) запущена и добавлена в автозагрузку. Для этого используется модуль service или systemd.

Пример задачи:

```
- name: Убедиться, что Nginx запущен и добавлен в автозагрузку
  service:
    name: nginx
    state: started
    enabled: yes

```

## 4. Копирование файлов конфигурации (модуль copy)

Модуль copy копирует файлы с управляющей машины на целевые серверы.

Пример:

```
- name: Скопировать кастомный конфиг
  copy:
    src: ./nginx.conf
    dest: /etc/nginx/nginx.conf
    owner: root
    group: root
    mode: '0644'

```
